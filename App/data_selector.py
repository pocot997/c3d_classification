import re
import pandas as pd

def extract_rows(file_name, start_row, end_row, output_file):
    # Wczytanie pliku csv
    data = pd.read_csv(file_name)

    # Pobranie wierszy z danego zakresu
    data_subset = data.iloc[start_row:end_row]

    # Zapisanie wybranych wierszy do nowego pliku csv
    data_subset.to_csv(output_file, header=False, index=False)

#data_labels = [406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 433, 434, 435, 442, 445, 446, 448, 449, 451, 453, 455, 456]
data_labels = [406, 407, 409, 410, 411, 412, 414, 415, 416, 417, 418, 419, 433, 434, 435, 442, 445, 446, 448, 449, 451, 453, 455, 456]

data_starting_rows = [[100, 350, 600, 850, 1100, 1350, 1600, 1850, 2100, 2350, 2600, 2850, 3100, 3350, 3600, 3850, 4100, 4350, 4600, 4850]]

for l in range(0, len(data_labels)):

    FILE_PATH = f"C:/Repos/Mgr/data_random_long/data_modeled_markers/long/{data_labels[l]}_long.csv"
    SAVE_PATH = f"C:/Repos/Mgr/data_random_long/data_modeled_markers/short/{data_labels[l]}"

    starting_rows = data_starting_rows[0]
    row_numbers = 250
    correction_offset = 2

    alphabet = "abcdefghijklmnopqrstuwxyz"

    regex = re.compile(r'\d+')
    regex.findall(FILE_PATH)
    label = [int(x) for x in regex.findall(FILE_PATH)]
    i = 0
    for row in starting_rows:
        save_path = f"{SAVE_PATH}/{label[0]}{alphabet[i]}.csv"
        i+=1
        star_row = row - correction_offset
        end_row = row - correction_offset + row_numbers
        extract_rows(FILE_PATH, star_row, end_row, save_path)

# 406 starting_rows = [23, 144, 254, 366, 474, 584, 695, 809, 929, 1044, 1158, 1275, 1388, 1508, 1624, 1743, 1856, 1979, 2099, 2216]
# 407 starting_rows = [50, 190, 328, 469, 605, 750, 885, 1019, 1156, 1290, 1427, 1564, 1702, 1837, 1974, 2116, 2254, 2390, 2531, 2667]
# 408 starting_rows = [111, 237, 367, 488, 611, 730, 848, 967, 1080, 1205, 1323, 1442, 1559, 1673, 1789, 1911, 2025, 2140, 2255, 2371]
# 409 starting_rows = [66, 179, 291, 397, 509, 617, 722, 828, 937, 1046, 1157, 1266, 1376, 1484, 1596, 1703, 1811, 1923, 2032, 2139]
# 410 starting_rows = [85, 197, 308, 424, 535, 644, 754, 862, 981, 1091, 1202, 1317, 1430, 1540, 1652, 1769, 1877, 1991, 2097, 2226]

# 411 starting_rows = [51, 183, 313, 449, 585, 718, 846, 974, 1113, 1241, 1378, 1508, 1645, 1772, 1900, 2030, 2158, 2286, 2422, 2552]
# 412 starting_rows = [44, 171, 295, 417, 550, 672, 797, 920, 1045, 1164, 1288, 1409, 1535, 1657, 1775, 1904, 2026, 2144, 2269, 2395]
# 413 starting_rows = [33, 154, 274, 394, 513, 635, 755, 877, 995, 1114, 1238, 1353, 1471, 1593, 1703, 1820, 1933, 2045, 2160, 2273]
# 414 starting_rows = [51, 171, 288, 415, 538, 659, 776, 889, 1003, 1118, 1242, 1359, 1479, 1597, 1720, 1836, 1953, 2069, 2186, 2300]
# 415 starting_rows = [27, 166, 307, 451, 586, 724, 864, 995, 1138, 1278, 1411, 1542, 1682, 1821, 1956, 2091, 2222, 2358, 2495, 2626]

# 416 starting_rows = [87, 202, 313, 423, 533, 642, 750, 857, 967, 1079, 1189, 1299, 1410, 1520, 1632, 1740, 1851, 1961, 2068, 2173]
# 417 starting_rows = [48, 203, 346, 489, 626, 763, 908, 1052, 1196, 1341, 1485, 1633, 1782, 1927, 2073, 2223, 2370, 2515, 2664, 2809]
# 418 starting_rows = [38, 146, 249, 354, 457, 565, 671, 776, 881, 984, 1092, 1195, 1298, 1402, 1507, 1608, 1711, 1812, 1914, 2016]
# 419 starting_rows = [97, 223, 349, 468, 585, 706, 825, 950, 1073, 1194, 1315, 1430, 1548, 1672, 1786, 1909, 2032, 2151, 2270, 2388]
# 433 starting_rows = [27, 149, 274, 395, 517, 640, 764, 891, 1014, 1136, 1261, 1383, 1508, 1629, 1751, 1874, 1996, 2119, 2243, 2366]

# 434 starting_rows = [51, 161, 274, 385, 495, 607, 717, 828, 939, 1046, 1156, 1266, 1378, 1489, 1601, 1712, 1823, 1935, 2046, 2155]
# 435 starting_rows = [83, 222, 351, 479, 606, 740, 874, 1008, 1138, 1274, 1401, 1539, 1677, 1817, 1942, 2085, 2226, 2361, 2491, 2627]
# 442 starting_rows = [60, 179, 297, 413, 530, 643, 758, 875, 995, 1112, 1231, 1346, 1461, 1574, 1689, 1801, 1915, 2030, 2147, 2263]
# 445 starting_rows = [39, 149, 259, 374, 485, 595, 706, 818, 930, 1044, 1158, 1274, 1384, 1486, 1597, 1704, 1817, 1926, 2034, 2142]
# 446 starting_rows = [110, 223, 337, 455, 569, 684, 804, 919, 1036, 1157, 1269, 1389, 1501, 1616, 1729, 1847, 1960, 2080, 2197, 2313]

# 448 starting_rows = [178, 300, 418, 533, 652, 775, 889, 1010, 1130, 1247, 1363, 1483, 1601, 1713, 1829, 1946, 2064, 2183, 2299, 2416]
# 449 starting_rows = [109, 224, 337, 447, 552, 665, 776, 890, 1001, 1114, 1228, 1340, 1453, 1567, 1681, 1793, 1906, 2014, 2127, 2236]
# 451 starting_rows = [160, 277, 391, 506, 624, 736, 852, 970, 1091, 1200, 1325, 1431, 1551, 1664, 1777, 1893, 2007, 2123, 2238, 2354]
# 453 starting_rows = [121, 237, 356, 474, 592, 721, 844, 965, 1086, 1212, 1335, 1457, 1585, 1707, 1833, 1959, 2088, 2212, 2350, 2479]
# 455 starting_rows = [94, 204, 317, 435, 547, 660, 770, 884, 998, 1112, 1221, 1336, 1455, 1568, 1686, 1797, 1909, 2024, 2138, 2252]

# 456 starting_rows = [132, 256, 380, 506, 626, 749, 869, 994, 1115, 1237, 1364, 1488, 1609, 1730, 1855, 1978, 2104, 2226, 2350, 2472]

# Random data_starting_rows = [[152, 456, 751, 1242, 1361, 1497, 1661, 1757, 1876, 1943, 2014, 2499, 2879, 3082, 3346, 3914, 4069, 4557, 4644]]

# data_starting_rows = [[23, 144, 254, 366, 474, 584, 695, 809, 929, 1044, 1158, 1275, 1388, 1508, 1624, 1743, 1856, 1979, 2099, 2216],
# [50, 190, 328, 469, 605, 750, 885, 1019, 1156, 1290, 1427, 1564, 1702, 1837, 1974, 2116, 2254, 2390, 2531, 2667],
# [111, 237, 367, 488, 611, 730, 848, 967, 1080, 1205, 1323, 1442, 1559, 1673, 1789, 1911, 2025, 2140, 2255, 2371],
# [66, 179, 291, 397, 509, 617, 722, 828, 937, 1046, 1157, 1266, 1376, 1484, 1596, 1703, 1811, 1923, 2032, 2139],
# [85, 197, 308, 424, 535, 644, 754, 862, 981, 1091, 1202, 1317, 1430, 1540, 1652, 1769, 1877, 1991, 2097, 2226],
# [51, 183, 313, 449, 585, 718, 846, 974, 1113, 1241, 1378, 1508, 1645, 1772, 1900, 2030, 2158, 2286, 2422, 2552],
# [44, 171, 295, 417, 550, 672, 797, 920, 1045, 1164, 1288, 1409, 1535, 1657, 1775, 1904, 2026, 2144, 2269, 2395],
# [33, 154, 274, 394, 513, 635, 755, 877, 995, 1114, 1238, 1353, 1471, 1593, 1703, 1820, 1933, 2045, 2160, 2273],
# [51, 171, 288, 415, 538, 659, 776, 889, 1003, 1118, 1242, 1359, 1479, 1597, 1720, 1836, 1953, 2069, 2186, 2300],
# [27, 166, 307, 451, 586, 724, 864, 995, 1138, 1278, 1411, 1542, 1682, 1821, 1956, 2091, 2222, 2358, 2495, 2626],
# [87, 202, 313, 423, 533, 642, 750, 857, 967, 1079, 1189, 1299, 1410, 1520, 1632, 1740, 1851, 1961, 2068, 2173],
# [48, 203, 346, 489, 626, 763, 908, 1052, 1196, 1341, 1485, 1633, 1782, 1927, 2073, 2223, 2370, 2515, 2664, 2809],
# [38, 146, 249, 354, 457, 565, 671, 776, 881, 984, 1092, 1195, 1298, 1402, 1507, 1608, 1711, 1812, 1914, 2016],
# [97, 223, 349, 468, 585, 706, 825, 950, 1073, 1194, 1315, 1430, 1548, 1672, 1786, 1909, 2032, 2151, 2270, 2388],
# [27, 149, 274, 395, 517, 640, 764, 891, 1014, 1136, 1261, 1383, 1508, 1629, 1751, 1874, 1996, 2119, 2243, 2366],
# [51, 161, 274, 385, 495, 607, 717, 828, 939, 1046, 1156, 1266, 1378, 1489, 1601, 1712, 1823, 1935, 2046, 2155],
# [83, 222, 351, 479, 606, 740, 874, 1008, 1138, 1274, 1401, 1539, 1677, 1817, 1942, 2085, 2226, 2361, 2491, 2627],
# [60, 179, 297, 413, 530, 643, 758, 875, 995, 1112, 1231, 1346, 1461, 1574, 1689, 1801, 1915, 2030, 2147, 2263],
# [39, 149, 259, 374, 485, 595, 706, 818, 930, 1044, 1158, 1274, 1384, 1486, 1597, 1704, 1817, 1926, 2034, 2142],
# [110, 223, 337, 455, 569, 684, 804, 919, 1036, 1157, 1269, 1389, 1501, 1616, 1729, 1847, 1960, 2080, 2197, 2313],
# [178, 300, 418, 533, 652, 775, 889, 1010, 1130, 1247, 1363, 1483, 1601, 1713, 1829, 1946, 2064, 2183, 2299, 2416],
# [109, 224, 337, 447, 552, 665, 776, 890, 1001, 1114, 1228, 1340, 1453, 1567, 1681, 1793, 1906, 2014, 2127, 2236],
# [160, 277, 391, 506, 624, 736, 852, 970, 1091, 1200, 1325, 1431, 1551, 1664, 1777, 1893, 2007, 2123, 2238, 2354],
# [121, 237, 356, 474, 592, 721, 844, 965, 1086, 1212, 1335, 1457, 1585, 1707, 1833, 1959, 2088, 2212, 2350, 2479],
# [94, 204, 317, 435, 547, 660, 770, 884, 998, 1112, 1221, 1336, 1455, 1568, 1686, 1797, 1909, 2024, 2138, 2252],
# [132, 256, 380, 506, 626, 749, 869, 994, 1115, 1237, 1364, 1488, 1609, 1730, 1855, 1978, 2104, 2226, 2350, 2472]]